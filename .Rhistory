c
sentiment.score <- summarise(group_by(tdm.idf.tidy.sentiment, document), sum(count))
sentiment.score$document <- substr(sentiment.score$document, 6, nchar(speeches)-4)
sentiment.score <- cSplit(sentiment.score, "document", "-")
names(sentiment.score)[names(sentiment.score)=="document_1"] <- "name"
names(sentiment.score)[names(sentiment.score)=="document_2"] <- "term"
sentiment.score$document_3 <- NULL
sentiment.score <- inner_join(sentiment.score,
as.data.frame(president.2),
by=c("name"="president.2"))
c <- ggplot(sentiment.score, aes(x=sentiment.score$name, y=sentiment.score$`sum(count)`, fill=sentiment.score$term)) +
geom_bar(stat="identity")
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name, y=sentiment.score$`sum(count)`, fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge")
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name, y=sentiment.score$`sum(count)`, fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.7)
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name, y=sentiment.score$`sum(count)`, fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6)
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name, y=sentiment.score$`sum(count)`, fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score")
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President")
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_discrete(main="Term")
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_discrete("Term")
c
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_discrete("Term", values=cbPalette)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette)
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=15, hjust = 1))
c
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
c
prex.out
sentiment.score.shift <- summarise(group_by(sentiment.score, name), diff(sum(count)))
names(sentiment.score)[names(sentiment.score)=="sum(count)"] <- "test"
sentiment.score.shift <- summarise(group_by(sentiment.score, name), diff(test))
summarise(group_by(sentiment.score, name), diff(test))
summarise(group_by(sentiment.score, name), sum(test))
sentiment.score$term <- NULL
sentiment.score.shift <- summarise(group_by(sentiment.score, name), diff(test))
aggregate(value~name, data=sentiment.score, FUN="diff")
aggregate(test~name, data=sentiment.score, FUN="diff")
sentiment.score <- summarise(group_by(tdm.idf.tidy.sentiment, document), sum(count))
sentiment.score$document <- substr(sentiment.score$document, 6, nchar(speeches)-4)
sentiment.score <- cSplit(sentiment.score, "document", "-")
names(sentiment.score)[names(sentiment.score)=="document_1"] <- "name"
names(sentiment.score)[names(sentiment.score)=="document_2"] <- "term"
sentiment.score$document_3 <- NULL
# Keep only presidents having done two terms
sentiment.score <- inner_join(sentiment.score,
as.data.frame(president.2),
by=c("name"="president.2"))
View(sentiment.score)
sentiment.score[sentiment.score$name == "AbrahamLincoln" && sentiment.score == "1"]
a <- sentiment.score[sentiment.score$name == "AbrahamLincoln" && sentiment.score == "1"]
View(a)
a <- sentiment.score[sentiment.score$name == "AbrahamLincoln" && sentiment.score$term == "1"]
View(a)
a <- sentiment.score[sentiment.score$name == "AbrahamLincoln" && sentiment.score$term == "1",]
a <- sentiment.score[sentiment.score$name == "AbrahamLincoln" & sentiment.score$term == "1",]
View(a)
a <- sentiment.score$`sum(count)`[sentiment.score$name == "AbrahamLincoln" & sentiment.score$term == "1",]
a <- sentiment.score[sentiment.score$name == "AbrahamLincoln" & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == "AbrahamLincoln" & sentiment.score$term == "2",1]
abs(a-b)
a <- sentiment.score[sentiment.score$name == president.2[1] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == president.2[1] & sentiment.score$term == "2",1]
abs(a-b)
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name == president.2[1] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == president.2[1] & sentiment.score$term == "2",1]
abs(a-b)
}
sentiment.score.shift <- data.frame(score=integer,
name=character(),
stringsAsFactors = F)
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score <- abs(a-b)
sentiment.score.shift$name <- president.2[i]
}
sentiment.score.shift <- data.frame(score=integer,
name=character(),
stringsAsFactors = F)
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- abs(a-b)
sentiment.score.shift$name[i] <- president.2[i]
}
View(sentiment.score.shift)
sentiment.score.shift <- data.frame(score=integer(),
name=character(),
stringsAsFactors = F)
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- abs(a-b)
sentiment.score.shift$name[i] <- president.2[i]
}
i = 1
a <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name == president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- abs(a-b)
sentiment.score.shift$name[i] <- president.2[i]
sentiment.score.shift <- data.frame(score=integer(),
name=character(),
stringsAsFactors = F,
nrows = 14)
sentiment.score.shift[i] <- c(1,"e")
sentiment.score.shift <- data.frame(score=integer(),
name=character(),
stringsAsFactors = F,
nrow=16)
sentiment.score.shift <- data.frame(score=integer(),
name=character(),
stringsAsFactors = F,
1:16)
sentiment.score.shift <- data.frame(1:16,score=integer(),
name=character(),
stringsAsFactors = F
)
sentiment.score.shift <- data.frame(1:16)
View(sentiment.score.shift)
View(sentiment.score.shift)
sentiment.score.shift <- data.frame(2:16)
result.frame = as.data.frame(matrix(ncol=2, nrow=length(president.2)))
sentiment.score.shift = as.data.frame(matrix(ncol=2, nrow=length(president.2)))
View(sentiment.score.shift)
sentiment.score.shift = as.data.frame(matrix(ncol=2, nrow=length(president.2)))
names(sentiment.score)[names(sentiment.score)=="V1"] <- "name"
names(sentiment.score)[names(sentiment.score)=="V2"] <- "score"
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- a-b
sentiment.score.shift$name[i] <- president.2[i]
}
sentiment.score.shift = as.data.frame(matrix(ncol=2, nrow=length(president.2)))
names(sentiment.score)[names(sentiment.score.shift)=="V1"] <- "name"
names(sentiment.score)[names(sentiment.score.shift)=="V2"] <- "score"
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- a-b
sentiment.score.shift$name[i] <- president.2[i]
}
View(sentiment.score.shift)
sentiment.score.shift = as.data.frame(matrix(ncol=2, nrow=length(president.2)))
names(sentiment.score)[names(sentiment.score.shift)=="V1"] <- "name"
View(sentiment.score)
sentiment.score <- summarise(group_by(tdm.idf.tidy.sentiment, document), sum(count))
sentiment.score$document <- substr(sentiment.score$document, 6, nchar(speeches)-4)
sentiment.score <- cSplit(sentiment.score, "document", "-")
names(sentiment.score)[names(sentiment.score)=="document_1"] <- "name"
names(sentiment.score)[names(sentiment.score)=="document_2"] <- "term"
sentiment.score$document_3 <- NULL
sentiment.score.shift = as.data.frame(matrix(ncol=2, nrow=length(president.2)))
names(sentiment.score.shift)[names(sentiment.score.shift)=="V1"] <- "name"
names(sentiment.score.shift)[names(sentiment.score.shift)=="V2"] <- "score"
for (i in 1:length(president.2)){
a <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- a-b
sentiment.score.shift$name[i] <- president.2[i]
}
i = 1
a <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",1]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",1]
a <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",3]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",3]
sentiment.score$name ==
president.2[i]
sentiment.score$term == "1"
sentiment.score$name ==
president.2[i] & sentiment.score$term == "1"
sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",1]
sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",4]
sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",]
a <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "1",]
View(a)
a <- sentiment.score[(sentiment.score$name ==
president.2[i] & sentiment.score$term == "1"),1]
sentiment.score[1,1]
sentiment.score[1,2]
sentiment.score[1,3]
sentiment.score <- as.data.frame(sentiment.score)
View(sentiment.score)
sentiment.score[1,3]
sentiment.score[1,2]
sentiment.score[1,1]
for (i in 1:length(president.2)){
a <- sentiment.score[(sentiment.score$name ==
president.2[i] & sentiment.score$term == "1"),1]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- a-b
sentiment.score.shift$name[i] <- president.2[i]
}
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
c
sentiment.score <- summarise(group_by(tdm.idf.tidy.sentiment, document), sum(count))
sentiment.score$document <- substr(sentiment.score$document, 6, nchar(speeches)-4)
sentiment.score <- cSplit(sentiment.score, "document", "-")
names(sentiment.score)[names(sentiment.score)=="document_1"] <- "name"
names(sentiment.score)[names(sentiment.score)=="document_2"] <- "term"
sentiment.score$document_3 <- NULL
# Keep only presidents having done two terms
sentiment.score <- inner_join(sentiment.score,
as.data.frame(president.2),
by=c("name"="president.2"))
c <- ggplot(sentiment.score, aes(x=sentiment.score$name,
y=sentiment.score$`sum(count)`,
fill=sentiment.score$term)) +
geom_bar(stat="identity", position = "dodge", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
c
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score$name,
y=sentiment.score$score) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score$name,
y=sentiment.score$score) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
#  theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score$name,
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score$name,
y=sentiment.score$score)) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
for (i in 1:length(president.2)){
a <- sentiment.score[(sentiment.score$name ==
president.2[i] & sentiment.score$term == "1"),1]
b <- sentiment.score[sentiment.score$name ==
president.2[i] & sentiment.score$term == "2",1]
sentiment.score.shift$score[i] <- -(a-b)
sentiment.score.shift$name[i] <- president.2[i]
}
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=cbPalette) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1)) +
scale_fill_manual(values=c(positive="firebrick1",negative="steelblue"))
d
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=c(positive="firebrick1",negative="steelblue")) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6, aes(fill = colour)) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=c(positive="firebrick1",negative="steelblue")) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
sentiment.score.shift$colour <- ifelse(sentiment.score.shift$score < 0, "negative","positive")
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6, aes(fill = colour)) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=c(positive="firebrick1",negative="steelblue")) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
sentiment.score.shift$colour <- ifelse(sentiment.score.shift$score < 0, "negative","positive")
d <- ggplot(sentiment.score.shift, aes(x=sentiment.score.shift$name,
y=sentiment.score.shift$score)) +
geom_bar(stat="identity", width=.6, aes(fill = colour)) +
ylab("Sentiment Score") +
xlab("President") +
scale_fill_manual("Term", values=c(positive="steelblue",negative="firebrick1")) +
theme(axis.text.x = element_text(angle = 45, size=12, hjust = 1))
d
View(tdm.idf.tidy)
tdm.idf.tidy.subset <- tdm.idf.tidy %>%
filter(book == "inaugAbrahamLincoln-1.txt")
tdm.idf.tidy.subset <- tdm.idf.tidy %>%
filter(document == "inaugAbrahamLincoln-1.txt")
View(tdm.idf.tidy.subset)
inspect(tdm[100:105,25:30])
tdm.subset <- tdm %>%
filter(document == "inaugAbrahamLincoln-1.txt")
corpus[[1]]$content
ff.all[[1]]$content
Test <- strsplit(ff.all[[1]]$content," ")
Test[34]
test2 <- Test[!sapply(Test, is.null)]
test2 <- Test[lapply(Test,length)!=0]
suu <- list(NULL, NULL, 1:2, matrix(1:4, 2))
suu[!sapply(suu, is.null)]
Test <- as.list(strsplit(ff.all[[1]]$content," "))
Test <- as.list(strsplit(ff.all[[1]]$content," "))
text_df <- data_frame(text = Test[1])
Test[1]
text_df <- data_frame(text = Test[[1]])
View(text_df)
text_df <- text_df[!is.null(text_df)]
View(text_df)
text_df[1,1]
text_df[2,1]
class(text_df[2,1])
test2 <- data_frame(text = ff.all[[1]]$content)
View(test2)
test2 %>%
unnest_tokens(word, text)
test3 <- unnest_tokens(test2,word, text)
rm(test)
rm(text_df)
test3$compteur <- c(1:length(test3))
View(test3)
1:10
1:length(test3)
length(test3)
ncol(test3)
nrow(test3)
test3$compteur <- c(1:nrow(test3))
View(test3)
nb.segments <- 20
test3$segment <- test3$compteur*nb.segments/nrow(test3)
View(test3)
test3$segment <- floor(test3$compteur*nb.segments/nrow(test3))
test4 <- inner_join(test3,
get_sentiments("bing"),
by=c("term"="word"))
test4 <- inner_join(test3,
get_sentiments("bing"),
by=c("word"="word"))
View(test4)
View(test3)
test4$new.compteur <- c(1:nrow(test4))
test4$new.segment <- floor(test4$new.compteur*nb.segments/nrow(test4))
tidy_books <- austen_books() %>%
group_by(book) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",
ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(word, text)
library(janeaustenr)
library(dplyr)
library(stringr)
tidy_books <- austen_books() %>%
group_by(book) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",
ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(word, text)
janeaustensentiment <- tidy_books %>%
inner_join(get_sentiments("bing")) %>%
count(book, index = linenumber %/% 100, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
library(tidyr)
janeaustensentiment <- tidy_books %>%
inner_join(get_sentiments("bing")) %>%
count(book, index = linenumber %/% 100, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
View(janeaustensentiment)
janeaustensentiment <- tidy_books %>%
inner_join(get_sentiments("bing")) %>%
)
janeaustensentiment <- tidy_books %>%
inner_join(get_sentiments("bing"))
test5 <- count(test4, new.segment, sentiment)
View(test5)
test6 <- mutate(test5, sentiment = positive - negative)
test6 <- spread(test5, sentiment, n, fill = 0)
View(test6)
test7 <- mutate(test6, sentiment = positive - negative)
View(test7)
ggplot(test7, aes(new.segment, sentiment) +
geom_bar(stat = "identity", show.legend = FALSE)
)
ggplot(test7, aes(new.segment, sentiment)) +
geom_bar(stat = "identity", show.legend = FALSE)
dummy <- inner_join(tdm.idf.tidy,
get_sentiments("bing"),
by=c("word"="word"))
dummy <- inner_join(tdm.idf.tidy,
get_sentiments("bing"),
by=c("term"="word"))
View(test4)
View(test5)
View(dummy)
dummy.positive <- dummy[dummy$sentiment=="positive"]
dummy.positive <- dummy[dummy$sentiment=="positive",]
dummy.negative <- dummy[dummy$sentiment=="negative",]
View(dummy.positive)
dummy.positive.test <- group.by(dummy.positive, document, sum(count))
dummy.positive.test <- group_by(dummy.positive, document, sum(count))
View(dummy.positive.test)
dummy.positive.test <- group_by(dummy.positive, term, sum(count))
dummy.positive.test <- summarise(group_by(dummy.positive, term), sum(count))
View(dummy.positive.test)
dummy.positive.test <- arrange(dummy.positive.test,desc(sum(count)))
names(dummy.positive.test)[names(dummy.positive.test)=="sum(count)"] <- "score"
dummy.positive.test <- arrange(dummy.positive.test, desc(score))
View(dummy.positive.test)
